---
title: "02-CheckFQs"
author: "jerod"
date: "June 29, 2016"
output: html_document
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(cache = TRUE)
```

Now we want to do some initial QC on the fastq files we just uploaded
```{r,echo=FALSE}
fastqdir="fastq/"
fastqlist<-list.files(path = fastqdir,pattern = ".fastq*")
```


```{r, echo=FALSE}
require(sevenbridges)
sevenbridgesapitoken="68916d51f8ba48c1a87a47f135bafef0"
authurl="https://api.sbgenomics.com/v2/" 
a<-Auth(sevenbridgesapitoken,url=authurl)
p<-a$project(name = "prototypeercc2")
```

First we want to run the analysis on all the files.
```{R, echo=FALSE}
# identify the app we're going to run [fastqc]
appid<-p$app(name="fastqc-analysis")
  
  for(fastq in fastqlist){
  # get the 7bridges file id associated with it    
  fileid<-p$file(name=fastq)[[1]]$id
  # prepare to run the app on the fastq files 
tsk <- p$task_add(name = paste0("FastQC Analysis of",fastq), 
           description = paste0("Run fastqc on",fastq), 
           app = appid,
           inputs = list(FASTQ_Reads=fileid))
tsk$run() # actually run it
  }
```
Then we want to actually look at the results.  The output of fastqc is preconfigured to be
in HTML, so we just need to have a navbar that points to those files.

```{R}
# TODO Lindsay to figure out how to show the results of the fastqc run...
# output file for file.fastq is file_fastqc.b64html
```


If we have to do any custom scripting or such, we just add it to docker and push that image:
http://docs.sevenbridges.com/docs/worked-example-of-uploading-a-custom-python-program

Would like to send all of the result plots to plotly because then we can compare across labs etc.  
It's open data, right?

Would also like to change the "html document" rendering options to utilize "code folding" because it's awesome.  
Once there are multiple sections at least.